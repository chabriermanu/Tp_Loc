-- DROP SCHEMA public;

CREATE SCHEMA public AUTHORIZATION pg_database_owner;

-- DROP SEQUENCE public.category_id_seq;

CREATE SEQUENCE public.category_id_seq
	INCREMENT BY 1
	MINVALUE 1
	MAXVALUE 2147483647
	START 1
	CACHE 1
	NO CYCLE;
-- DROP SEQUENCE public.item_id_seq;

CREATE SEQUENCE public.item_id_seq
	INCREMENT BY 1
	MINVALUE 1
	MAXVALUE 2147483647
	START 1
	CACHE 1
	NO CYCLE;
-- DROP SEQUENCE public.loan_id_seq;

CREATE SEQUENCE public.loan_id_seq
	INCREMENT BY 1
	MINVALUE 1
	MAXVALUE 2147483647
	START 1
	CACHE 1
	NO CYCLE;
-- DROP SEQUENCE public.messenger_messages_id_seq;

CREATE SEQUENCE public.messenger_messages_id_seq
	INCREMENT BY 1
	MINVALUE 1
	MAXVALUE 9223372036854775807
	START 1
	CACHE 1
	NO CYCLE;
-- DROP SEQUENCE public.user_id_seq;

CREATE SEQUENCE public.user_id_seq
	INCREMENT BY 1
	MINVALUE 1
	MAXVALUE 2147483647
	START 1
	CACHE 1
	NO CYCLE;-- public.category definition

-- Drop table

-- DROP TABLE public.category;

CREATE TABLE public.category (
	id int4 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 2147483647 START 1 CACHE 1 NO CYCLE) NOT NULL,
	"name" varchar(50) NOT NULL,
	points int4 NOT NULL,
	CONSTRAINT category_pkey PRIMARY KEY (id)
);


-- public.doctrine_migration_versions definition

-- Drop table

-- DROP TABLE public.doctrine_migration_versions;

CREATE TABLE public.doctrine_migration_versions (
	"version" varchar(191) NOT NULL,
	executed_at timestamp(0) DEFAULT NULL::timestamp without time zone NULL,
	execution_time int4 NULL,
	CONSTRAINT doctrine_migration_versions_pkey PRIMARY KEY (version)
);


-- public.messenger_messages definition

-- Drop table

-- DROP TABLE public.messenger_messages;

CREATE TABLE public.messenger_messages (
	id int8 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 9223372036854775807 START 1 CACHE 1 NO CYCLE) NOT NULL,
	body text NOT NULL,
	headers text NOT NULL,
	queue_name varchar(190) NOT NULL,
	created_at timestamp(0) NOT NULL,
	available_at timestamp(0) NOT NULL,
	delivered_at timestamp(0) DEFAULT NULL::timestamp without time zone NULL,
	CONSTRAINT messenger_messages_pkey PRIMARY KEY (id)
);
CREATE INDEX idx_75ea56e016ba31db ON public.messenger_messages USING btree (delivered_at);
CREATE INDEX idx_75ea56e0e3bd61ce ON public.messenger_messages USING btree (available_at);
CREATE INDEX idx_75ea56e0fb7336f0 ON public.messenger_messages USING btree (queue_name);


-- public."user" definition

-- Drop table

-- DROP TABLE public."user";

CREATE TABLE public."user" (
	id int4 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 2147483647 START 1 CACHE 1 NO CYCLE) NOT NULL,
	email varchar(180) NOT NULL,
	roles json NOT NULL,
	"password" varchar(255) NOT NULL,
	points int4 NOT NULL,
	CONSTRAINT user_pkey PRIMARY KEY (id)
);
CREATE UNIQUE INDEX uniq_identifier_email ON public."user" USING btree (email);


-- public.item definition

-- Drop table

-- DROP TABLE public.item;

CREATE TABLE public.item (
	id int4 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 2147483647 START 1 CACHE 1 NO CYCLE) NOT NULL,
	"name" varchar(100) NOT NULL,
	description text NOT NULL,
	picture varchar(255) DEFAULT NULL::character varying NULL,
	category_id int4 NULL,
	id_user_id int4 NULL,
	CONSTRAINT item_pkey PRIMARY KEY (id),
	CONSTRAINT fk_1f1b251e12469de2 FOREIGN KEY (category_id) REFERENCES public.category(id),
	CONSTRAINT fk_1f1b251e79f37ae5 FOREIGN KEY (id_user_id) REFERENCES public."user"(id)
);
CREATE INDEX idx_1f1b251e12469de2 ON public.item USING btree (category_id);
CREATE INDEX idx_1f1b251e79f37ae5 ON public.item USING btree (id_user_id);


-- public.loan definition

-- Drop table

-- DROP TABLE public.loan;

CREATE TABLE public.loan (
	id int4 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 2147483647 START 1 CACHE 1 NO CYCLE) NOT NULL,
	"start" date NOT NULL,
	fin date NOT NULL,
	status varchar(20) NOT NULL,
	returned_at date NULL,
	item_id int4 NULL,
	id_user_id int4 NULL,
	CONSTRAINT loan_pkey PRIMARY KEY (id),
	CONSTRAINT fk_c5d30d03126f525e FOREIGN KEY (item_id) REFERENCES public.item(id),
	CONSTRAINT fk_c5d30d0379f37ae5 FOREIGN KEY (id_user_id) REFERENCES public."user"(id)
);
CREATE INDEX idx_c5d30d03126f525e ON public.loan USING btree (item_id);
CREATE INDEX idx_c5d30d0379f37ae5 ON public.loan USING btree (id_user_id);
